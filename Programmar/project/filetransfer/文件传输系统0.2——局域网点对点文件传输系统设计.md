# 文件传输系统0.2——局域网点对点文件传输系统设计

## 目标与背景

1. 当下市场上的智能终端有相当多的厂商，例如华为，苹果，小米等厂商的手机、电脑、平板等。
2. 不同的厂商都在致力于打造自己的生态圈，想要在互联网上建立一道生态壁垒。
3. 相同生态内终端的信息传输无比通畅，但不同生态终端间的数据传输却可能无比麻烦。
4. 目前解决不同终端间文件传输的方案有多种多样:
    1. 例如我们可以使用QQ、微信这些聊天软件传输，但是这种传输方式，数据流会经过第三方服务器。
       这么做，流量消耗可能是一个问题，另一个更大的问题是，用户是否可以无条件相信第三方中转站？毕竟中转站是有能力偷窥用户数据的。
    2. 在开源项目中也有一个解决方案，其实现就是Snapdrop，一个基于点对点的文件传输系统，没有流量和隐私问题，是一个非常棒的案例。
       但是这个应用仍有不足的地方，它无法传输文件大小超过接收端空闲内存的文件。另外，这个应用的用户体验仍然有较大的进步空间。

笔者要做的就是模仿Snapdrop，并**超越**该项目。

## 分析Snapdrop

### 可借鉴之处

1. 提供了基于WebRTC文件传输的案例
2. 提供了信令服务器的实现案例

### 不足之处

1. 无法传输大型文件，视接收端的空闲内存大小而定。
2. 同时传输多个文件的连续性体验不好，接收端必须在下一个文件传输完成前点击下载，这意味着接收端必须有人去看管。理想情况下应该是接收端自动把文件下载到本地。

## 功能规格说明

1. 同一个上传接口，支持表单上传，也支持二进制上传。
2. 上传接口在表单模式下仅需支持单个文件上传。
3. 编写一个简单的文件传输页面，方便用户操作。
4. 安全需求：`HTTP`连接使用的安全协议不低于`TLSv1.2`。（疑似0.1遗留需求）
5. 支持查询传输进度。（0.1遗留需求）

# 系统设计

## 技术要求

1. Golang
2. redis
3. docker
4. vue
5. WebRTC
6. Service Worker API

### 信息架构图

![信息架构图](docImg/information_architecture_diagram.png)

### 视觉辞典

![视觉辞典](docImg/visual_dictionary.png)

## 任务规划

## 参考文献

1. [Snapdrop-webapp](https://drop.ioiox.com/)
2. [Snapdrop-Github](https://github.com/RobinLinus/snapdrop)